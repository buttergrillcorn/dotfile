#+TITLE: Arch Linux Dotfiles
#+AUTHOR: James
#+STARTUP: overview

Minimal Arch Linux dotfiles managed with org-mode and GNU Stow.

* Stack
- *WM*: sway
- *Bar*: waybar
- *Notifications*: mako
- *Launcher*: fuzzel
- *Terminal*: foot
- *File Manager*: yazi
- *Browser*: qutebrowser
- *Lock*: waylock
- *Idle*: swayidle
- *Shell*: zsh
- *Theming*: pywal

* Installation

** Prerequisites
#+begin_src sh
sudo pacman -S emacs stow git
#+end_src

** Required Packages
#+begin_src sh
sudo pacman -S sway swaybg waybar mako fuzzel foot yazi qutebrowser waylock swayidle zsh python-pywal autotiling
#+end_src

** Additional Dependencies
#+begin_src sh
# Audio control
sudo pacman -S pamixer

# Screenshot utilities
sudo pacman -S grim slurp sway-contrib

# Clipboard management
sudo pacman -S wl-clipboard cliphist

# Screen color temperature
sudo pacman -S wlsunset

# Brightness control
sudo pacman -S light

# Input method (for Chinese/multilingual)
sudo pacman -S fcitx5 fcitx5-configtool

# Shell enhancements
sudo pacman -S zoxide bat trash-cli fastfetch

# System utilities
sudo pacman -S udiskie wluma

# KDE Connect
sudo pacman -S kdeconnect
#+end_src

** Optional Tools
#+begin_src sh
# File manager GUI
sudo pacman -S thunar

# Network management
sudo pacman -S networkmanager nm-applet networkmanager_dmenu
#+end_src

* Features

** Keybindings
- *Mod (Super/Win) + Return*: Terminal
- *Mod + Shift + Return*: Floating terminal
- *Mod + D*: Application launcher (fuzzel)
- *Mod + B*: Browser (qutebrowser)
- *Mod + E*: File manager (yazi in terminal)
- *Mod + N*: Emacs client
- *Mod + Q*: Close window
- *Mod + F*: Toggle floating
- *Mod + Shift + F*: Fake fullscreen (global)
- *Mod + Shift + Ctrl + F*: True fullscreen
- *Mod + Tab*: Swap focus (floating â†” tiling)
- *Mod + R*: Resize mode (use hjkl or arrows)
- *Mod + H/J/K/L*: Navigate windows (vim keys)
- *Mod + Ctrl + H/J/K/L*: Move windows
- *Mod + Ctrl + Shift + Direction*: Move window to output
- *Mod + 1-9*: Switch workspaces
- *Mod + Shift + 1-9*: Move window to workspace
- *Mod + Ctrl + 1-9*: Move window to workspace and follow
- *Mod + W*: Show scratchpad
- *Mod + Shift + W*: Move to scratchpad
- *Mod + Shift + Minus*: Split horizontally
- *Mod + Shift + V*: Split vertically
- *Mod + Shift + S*: Toggle split layout
- *Mod + Ctrl + S*: Toggle sticky
- *Mod + M*: Notification actions
- *Mod + V*: Clipboard manager
- *XF86 Keys*: Volume, brightness, screenshot controls

** Input Configuration
- Caps Lock swapped with Ctrl
- Touchpad tap-to-click enabled
- Natural scrolling
- Middle mouse emulation
- Disable-while-typing enabled (touchpad & trackpoint)
- Focus follows mouse

** Theming
- Pywal integration for dynamic colors
- Minimal fallback color scheme
- 10px gaps between windows
- 2px borders
- Noweb-based shared variables for easy theming

** Window Rules
- Picture-in-Picture windows: floating, no border, bottom-right corner, sticky
- Floating terminal: centered, 60% width/height
- Auto-floating apps: bluetooth managers, audio control, kdeconnect, etc.

** Tiling Behavior
- Autotiling: Automatically switches between horizontal/vertical splits based on window dimensions
- Manual split controls: Mod+Shift+Minus (horizontal), Mod+Shift+V (vertical)
- Resize mode with vim keys or arrows

** Power Management
- Conditional swayidle timeouts:
  - Battery: 5min screen off, 10min lock, 30min sleep
  - Plugged in: 10min screen off, 15min lock, 1hr sleep
- Lid close: screen off, lock, and sleep
- Lid open: wake screen

* Setup

After installing packages, follow these steps:

** 1. Clone repository
#+begin_src sh
git clone <your-repo-url> ~/dotfiles
cd ~/dotfiles
#+end_src

** 2. Tangle configurations
#+begin_src sh
./scripts/tangle.sh
#+end_src

This extracts all code blocks from =dotfiles.org= into =packages/=.

** 3. Stow packages
#+begin_src sh
# Deploy all packages
./scripts/stow-pkg.sh sway waybar mako fuzzel foot yazi qutebrowser swaylock swayidle zsh pywal

# Or deploy specific packages
./scripts/stow-pkg.sh sway waybar mako

# Make scripts executable
chmod +x ~/dotfile/packages/zsh/.local/bin/select-wm.sh
chmod +x ~/dotfile/packages/swayidle/.local/bin/start-swayidle.sh
#+end_src

** 4. Launch sway
#+begin_src sh
# From TTY (auto-login configured in zsh)
# Or manually:
sway
#+end_src

* Usage

** Edit configuration
Edit =dotfiles.org= in Emacs, then re-tangle and re-stow.

** Unstow packages
#+begin_src sh
stow -d packages -t ~ -D sway
#+end_src

** Switch window managers
#+begin_src sh
stow -d packages -t ~ -D sway
./scripts/stow-pkg.sh river
#+end_src

** Change wallpaper and theme
#+begin_src sh
# Change wallpaper and generate colors with pywal
./scripts/change-theme.sh ~/dotfile/wallpapers/your-wallpaper.jpg

# Or manually with pywal
wal -i ~/dotfile/wallpapers/your-wallpaper.jpg -n
#+end_src

** Setup auto-login (optional)
#+begin_src sh
# Create getty override for auto-login on TTY1
sudo mkdir -p /etc/systemd/system/getty@tty1.service.d/
sudo tee /etc/systemd/system/getty@tty1.service.d/autologin.conf << EOF
[Service]
ExecStart=
ExecStart=-/sbin/agetty -o '-p -f $USER' --noclear --autologin $USER %I \$TERM
EOF

# Enable the service
sudo systemctl enable getty@tty1.service
#+end_src

After auto-login is configured, sway will start automatically on TTY1.

* Structure
- =dotfiles.org= - Main configuration file (edit this)
- =scripts/= - Helper scripts
- =packages/= - Generated configs (do not edit directly)

* Extending
Add new configurations to =dotfiles.org= with proper tangle headers, then re-run =./scripts/tangle.sh=.
* TO-DO's
** Sway/WM
*** TODO Implement a helper pop-up function to show common shortcut or useful features, for anyone using the computer or in case I forget.
** Misc
*** TODO Add zsh plugins (syntax highlighting, autosuggestions, completions)
** Waybar
*** TODO Implement a module for showing how many packages need updating on Waybar
*** TODO Scratchpad status.
